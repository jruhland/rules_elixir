load("@rules_elixir//impl:defs.bzl", "mix_project")

def autogenerated_targets(overrides = {}):
  mix_project(
    name = "umbrella",
    mix_env = "dev",
    config_path = "config/config.exs",
    build_path = "_build/dev",
    apps_path = "apps",
    deps_graph = {
                   "app_one": {
                                "deps": ["common", "jason"],
                                "in_umbrella": "true",
                                "inputs": ["app_one", "common",
                                           "common_library", "jason"],
                                "path": "apps/app_one"
                              },
                   "app_two": {
                                "deps": ["common", "mimerl", "only_runtime"],
                                "in_umbrella": "true",
                                "inputs": ["app_two", "common",
                                           "common_library", "mimerl",
                                           "only_runtime"],
                                "path": "apps/app_two"
                              },
                   "common": {
                               "deps": ["common_library"],
                               "in_umbrella": "true",
                               "inputs": ["common", "common_library"],
                               "path": "apps/common"
                             },
                   "common_library": {
                                       "deps": [],
                                       "inputs": ["common_library"],
                                       "path": "libraries/common_library"
                                     },
                   "jason": {
                              "deps": [],
                              "inputs": ["jason"],
                              "path": "deps/jason"
                            },
                   "mimerl": {
                               "deps": [],
                               "inputs": ["mimerl"],
                               "path": "deps/mimerl"
                             },
                   "only_runtime": {
                                     "deps": [],
                                     "in_umbrella": "true",
                                     "inputs": ["only_runtime"],
                                     "path": "apps/only_runtime"
                                   }
                 },
    external_projects = {
                          "common_library": "libraries/common_library",
                          "jason": "deps/jason",
                          "mimerl": "deps/mimerl"
                        },
    apps_targets = {
                     "app_one": ["//test/mix/umbrella/apps/app_one/lib:app_one",
                                 "//test/mix/umbrella/apps/app_one/lib:macros"],
                     "app_two": ["//test/mix/umbrella/apps/app_two/lib:app_two",
                                 "//test/mix/umbrella/apps/app_two/lib:mock_action",
                                 "//test/mix/umbrella/apps/app_two/lib:real_action",
                                 "//test/mix/umbrella/apps/app_two/lib:some_module"],
                     "common": ["//test/mix/umbrella/apps/common/lib:common",
                                "//test/mix/umbrella/apps/common/lib:compiletime_util",
                                "//test/mix/umbrella/apps/common/lib:macros"],
                     "only_runtime": ["//test/mix/umbrella/apps/only_runtime/lib:only_runtime"]
                   }
  )

